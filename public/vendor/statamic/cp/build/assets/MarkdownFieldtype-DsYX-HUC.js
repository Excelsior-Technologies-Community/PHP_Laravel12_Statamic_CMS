import{F as de,G as Y,_ as ne,H as ce,I as ue,J as se,r as T,i as ie,d as E,o as k,k as F,m as $,n as V,K as le,L as ae,w as z,c as P,q as D,M as he,N as fe,U as ge,O as pe,P as me,b as ve,f as y,Q as W,t as U,v as X,p as ke,R as we,S as be,T as ye,V as xe,W as _e}from"./index-A5ZmM1kw.js";class Se extends de{#e=!1;constructor(e=!1,r){super(r),this.#e=!!e}code(e){if(!this.#e)return e.text;let r="";return e.lang&&(r=`${e.lang}:
`),e.text.split(`
`).forEach(i=>{r=`${r}	${i}
`}),r}blockquote({tokens:e}){const r=this.parser.parse(e);let i=r;return i.endsWith(`
`)&&(i=i.slice(0,-1)),this.#e?`
	"${r.split(`
`).map((n,s)=>s===0?n:n==="	"||n===""?"":`	${n}`).join(`
`)}"
`:`"${r}"
`}html(){return""}heading(e){const r=e.text;if(this.#e){if(e.depth===1)return`
${r}

`;if(e.depth===2)return`
${r}
`}return`${r}
`}hr(){return this.#e?`${"-".repeat(25)}
`:`
`}list({items:e}){return`${e.map(r=>this.listitem(r)).join(`
`)}
`}listitem(e){return`- ${e.text}`}checkbox(e){return this.#e?e.checked?`[x]
`:`[ ]
`:""}paragraph({tokens:e}){return`${this.parser.parseInline(e)}
`}table(e){return`${e.header}
${e.rows.flatMap(r=>r.map(i=>i.text)).join(`
`)}
`}tablerow(e){return this.#e?e.text.slice(1)+` |
`:`
${e.text}
`}tablecell(e){return this.#e?` | ${e.text}`:e.text}strong(e){return this.#e?e.text.toUpperCase():e.text}em({tokens:e}){return this.#e?`*${this.parser.parseInline(e)}*`:this.parser.parseInline(e)}codespan(e){return this.#e?`\`${e.text}\``:e.text}br(){return`
`}del(e){return this.#e?`~${e.text}~`:e.text}link(e){if(!this.#e)return e.text;const{href:r,title:i,text:n}=e;return`${n} (${i?`${i} `:""}${r})`}image(e){if(!this.#e)return e.text;const{href:r,title:i,text:n}=e;return`${n}(${i?`${i} `:""}${r})`}text(e){return e.text}}var N={exports:{}},Z;function Ce(){return Z||(Z=1,function(t,e){(function(r){r(Y())})(function(r){var i={pairs:`()[]{}''""`,closeBefore:`)]}'":;>`,triples:"",explode:"[]{}"},n=r.Pos;r.defineOption("autoCloseBrackets",!1,function(o,l,d){d&&d!=r.Init&&(o.removeKeyMap(a),o.state.closeBrackets=null),l&&(c(s(l,"pairs")),o.state.closeBrackets=l,o.addKeyMap(a))});function s(o,l){return l=="pairs"&&typeof o=="string"?o:typeof o=="object"&&o[l]!=null?o[l]:i[l]}var a={Backspace:f,Enter:w};function c(o){for(var l=0;l<o.length;l++){var d=o.charAt(l),u="'"+d+"'";a[u]||(a[u]=S(d))}}c(i.pairs+"`");function S(o){return function(l){return A(l,o)}}function v(o){var l=o.state.closeBrackets;if(!l||l.override)return l;var d=o.getModeAt(o.getCursor());return d.closeBrackets||l}function f(o){var l=v(o);if(!l||o.getOption("disableInput"))return r.Pass;for(var d=s(l,"pairs"),u=o.listSelections(),h=0;h<u.length;h++){if(!u[h].empty())return r.Pass;var x=R(o,u[h].head);if(!x||d.indexOf(x)%2!=0)return r.Pass}for(var h=u.length-1;h>=0;h--){var g=u[h].head;o.replaceRange("",n(g.line,g.ch-1),n(g.line,g.ch+1),"+delete")}}function w(o){var l=v(o),d=l&&s(l,"explode");if(!d||o.getOption("disableInput"))return r.Pass;for(var u=o.listSelections(),h=0;h<u.length;h++){if(!u[h].empty())return r.Pass;var x=R(o,u[h].head);if(!x||d.indexOf(x)%2!=0)return r.Pass}o.operation(function(){var g=o.lineSeparator()||`
`;o.replaceSelection(g+g,null),b(o,-1),u=o.listSelections();for(var _=0;_<u.length;_++){var q=u[_].head.line;o.indentLine(q,null,!0),o.indentLine(q+1,null,!0)}})}function b(o,l){for(var d=[],u=o.listSelections(),h=0,x=0;x<u.length;x++){var g=u[x];g.head==o.getCursor()&&(h=x);var _=g.head.ch||l>0?{line:g.head.line,ch:g.head.ch+l}:{line:g.head.line-1};d.push({anchor:_,head:_})}o.setSelections(d,h)}function C(o){var l=r.cmpPos(o.anchor,o.head)>0;return{anchor:new n(o.anchor.line,o.anchor.ch+(l?-1:1)),head:new n(o.head.line,o.head.ch+(l?1:-1))}}function A(o,l){var d=v(o);if(!d||o.getOption("disableInput"))return r.Pass;var u=s(d,"pairs"),h=u.indexOf(l);if(h==-1)return r.Pass;for(var x=s(d,"closeBefore"),g=s(d,"triples"),_=u.charAt(h+1)==l,q=o.listSelections(),K=h%2==0,O,j=0;j<q.length;j++){var J=q[j],m=J.head,B,H=o.getRange(m,n(m.line,m.ch+1));if(K&&!J.empty())B="surround";else if((_||!K)&&H==l)_&&p(o,m)?B="both":g.indexOf(l)>=0&&o.getRange(m,n(m.line,m.ch+3))==l+l+l?B="skipThree":B="skip";else if(_&&m.ch>1&&g.indexOf(l)>=0&&o.getRange(n(m.line,m.ch-2),m)==l+l){if(m.ch>2&&/\bstring/.test(o.getTokenTypeAt(n(m.line,m.ch-2))))return r.Pass;B="addFour"}else if(_){var Q=m.ch==0?" ":o.getRange(n(m.line,m.ch-1),m);if(!r.isWordChar(H)&&Q!=l&&!r.isWordChar(Q))B="both";else return r.Pass}else if(K&&(H.length===0||/\s/.test(H)||x.indexOf(H)>-1))B="both";else return r.Pass;if(!O)O=B;else if(O!=B)return r.Pass}var L=h%2?u.charAt(h-1):l,G=h%2?l:u.charAt(h+1);o.operation(function(){if(O=="skip")b(o,1);else if(O=="skipThree")b(o,3);else if(O=="surround"){for(var M=o.getSelections(),I=0;I<M.length;I++)M[I]=L+M[I]+G;o.replaceSelections(M,"around"),M=o.listSelections().slice();for(var I=0;I<M.length;I++)M[I]=C(M[I]);o.setSelections(M)}else O=="both"?(o.replaceSelection(L+G,null),o.triggerElectric(L+G),b(o,-1)):O=="addFour"&&(o.replaceSelection(L+L+L+L,"before"),b(o,1))})}function R(o,l){var d=o.getRange(n(l.line,l.ch-1),n(l.line,l.ch+1));return d.length==2?d:null}function p(o,l){var d=o.getTokenAt(n(l.line,l.ch+1));return/\bstring/.test(d.type)&&d.start==l.ch&&(l.ch==0||!/\bstring/.test(o.getTokenTypeAt(l)))}})}()),N.exports}Ce();var ee={exports:{}},te;function Te(){return te||(te=1,function(t,e){(function(r){r(Y())})(function(r){r.defineOption("autoRefresh",!1,function(s,a){s.state.autoRefresh&&(n(s,s.state.autoRefresh),s.state.autoRefresh=null),a&&s.display.wrapper.offsetHeight==0&&i(s,s.state.autoRefresh={delay:a.delay||250})});function i(s,a){function c(){s.display.wrapper.offsetHeight?(n(s,a),s.display.lastWrapHeight!=s.display.wrapper.clientHeight&&s.refresh()):a.timeout=setTimeout(c,a.delay)}a.timeout=setTimeout(c,a.delay),a.hurry=function(){clearTimeout(a.timeout),a.timeout=setTimeout(c,50)},r.on(window,"mouseup",a.hurry),r.on(window,"keyup",a.hurry)}function n(s,a){clearTimeout(a.timeout),r.off(window,"mouseup",a.hurry),r.off(window,"keyup",a.hurry)}})}()),ee.exports}Te();var re={exports:{}},oe;function Re(){return oe||(oe=1,function(t,e){(function(r){r(Y())})(function(r){var i=/^(\s*)(>[> ]*|[*+-] \[[x ]\]\s|[*+-]\s|(\d+)([.)]))(\s*)/,n=/^(\s*)(>[> ]*|[*+-] \[[x ]\]|[*+-]|(\d+)[.)])(\s*)$/,s=/[*+-]\s/;r.commands.newlineAndIndentContinueMarkdownList=function(c){if(c.getOption("disableInput"))return r.Pass;for(var S=c.listSelections(),v=[],f=0;f<S.length;f++){var w=S[f].head,b=c.getStateAfter(w.line),C=r.innerMode(c.getMode(),b);if(C.mode.name!=="markdown"&&C.mode.helperType!=="markdown"){c.execCommand("newlineAndIndent");return}else b=C.state;var A=b.list!==!1,R=b.quote!==0,p=c.getLine(w.line),o=i.exec(p),l=/^\s*$/.test(p.slice(0,w.ch));if(!S[f].empty()||!A&&!R||!o||l){c.execCommand("newlineAndIndent");return}if(n.test(p)){var d=R&&/>\s*$/.test(p),u=!/>\s*$/.test(p);(d||u)&&c.replaceRange("",{line:w.line,ch:0},{line:w.line,ch:w.ch+1}),v[f]=`
`}else{var h=o[1],x=o[5],g=!(s.test(o[2])||o[2].indexOf(">")>=0),_=g?parseInt(o[3],10)+1+o[4]:o[2].replace("x"," ");v[f]=`
`+h+_+x,g&&a(c,w)}}c.replaceSelections(v)};function a(c,S){var v=S.line,f=0,w=0,b=i.exec(c.getLine(v)),C=b[1];do{f+=1;var A=v+f,R=c.getLine(A),p=i.exec(R);if(p){var o=p[1],l=parseInt(b[3],10)+f-w,d=parseInt(p[3],10),u=d;if(C===o&&!isNaN(d))l===d&&(u=d+1),l>d&&(u=l+1),c.replaceRange(R.replace(i,o+u+p[4]+p[5]),{line:A,ch:0},{line:A,ch:R.length});else{if(C.length>o.length||C.length<o.length&&f===1)return;w+=1}}}while(p)}})}()),re.exports}Re();const Fe={components:{Button:se,ToggleGroup:ue,ToggleItem:ce},props:{buttons:{type:Array,required:!0},isReadOnly:{type:Boolean,default:!1},showDarkMode:{type:Boolean,default:!1},darkMode:{type:Boolean,default:!1},isFullscreen:{type:Boolean,default:!1}},data(){return{mode:"write"}},watch:{mode(t){this.$emit("update:mode",t)}},emits:["update:mode","toggle-dark-mode","button-click"],methods:{handleButtonClick(t){this.$emit("button-click",t.command)}}},Ae={"data-markdown-toolbar":""};function Be(t,e,r,i,n,s){const a=T("Button"),c=T("ToggleItem"),S=T("ToggleGroup"),v=ie("tooltip");return k(),E("div",Ae,[r.isReadOnly?F("",!0):(k(),E("div",{key:0,class:V(["flex items-center",{"gap-2":r.isFullscreen}])},[(k(!0),E(le,null,ae(r.buttons,f=>z((k(),P(a,{"aria-label":f.text,icon:f.svg,key:f.name,onClick:w=>s.handleButtonClick(f),size:"sm",variant:"ghost"},null,8,["aria-label","icon","onClick"])),[[v,f.text]])),128))],2)),$(S,{modelValue:n.mode,"onUpdate:modelValue":e[0]||(e[0]=f=>n.mode=f),size:"sm",class:"-me-1","data-markdown-mode-toggle":""},{default:D(()=>[z($(c,{icon:"pencil",value:"write"},null,512),[[v,t.__("Writing Mode")]]),z($(c,{icon:"eye",value:"preview"},null,512),[[v,t.__("Preview Mode")]])]),_:1},8,["modelValue"])])}const Me=ne(Fe,[["render",Be]]);function Ie(t){const e=[];let r=0;const i=t.length;for(;r<i;){const n=t.charCodeAt(r++);if(n>=55296&&n<=56319&&r<i){const s=t.charCodeAt(r++);(s&64512)==56320?e.push(((n&1023)<<10)+(s&1023)+65536):(e.push(n),r--)}else e.push(n)}return e}const $e={mixins:[ve],components:{Button:se,AssetSelector:me,Uploader:pe,Uploads:ge,MarkdownToolbar:Me,Stack:fe},data(){return{data:this.value||"",buttons:[],mode:"write",selections:null,showAssetSelector:!1,selectedAssets:[],draggingFile:!1,showCheatsheet:!1,fullScreenMode:!1,darkMode:!1,codemirror:null,uploads:[],count:{characters:0,words:0},escBinding:null,markdownPreviewText:null,showFloatingToolbar:!1,floatingToolbarX:0,floatingToolbarY:0}},watch:{data:{handler(t){this.updateDebounced(t),this.updateCount(t)}},mode:{handler(t){t==="preview"&&this.updateMarkdownPreview()}},readOnly:{handler(t){this.codemirror.setOption("readOnly",t?"nocursor":!1)}}},mounted(){this.initToolbarButtons(),this.$nextTick(()=>{this.initCodeMirror()}),this.data&&this.updateCount(this.data)},beforeUnmount(){this.$events.$off("livepreview.opened",this.throttledResizeEvent),this.$events.$off("livepreview.closed",this.throttledResizeEvent),this.$events.$off("livepreview.resizing",this.throttledResizeEvent),this.codemirror&&this.toolbarIsFloating&&(this.codemirror.off("cursorActivity",this.handleCursorActivity),this.codemirror.off("blur",this.hideFloatingToolbar))},methods:{closeFullScreen(){this.fullScreenMode=!1,this.escBinding.destroy(),this.trackHeightUpdates()},openFullScreen(){this.fullScreenMode=!0,this.escBinding=this.$keys.bindGlobal("esc",this.closeFullScreen),this.trackHeightUpdates(),this.$nextTick(()=>{this.codemirror&&this.codemirror.focus()})},toggleFullscreen(){this.fullScreenMode?this.closeFullScreen():this.openFullScreen()},toggleDarkMode(){this.darkMode=!this.darkMode},getText(t){const e=this.selections.indexOf(t);return this.codemirror.getSelections()[e]},toggleInline(t){const e={bold:{pattern:/^\*{2}(.*)\*{2}$/,delimiter:"**"},code:{pattern:/^\`(.*)\`$/,delimiter:"`"},italic:{pattern:/^\_(.*)\_$/,delimiter:"_"},strikethrough:{pattern:/^\~\~(.*)\~\~$/,delimiter:"~~"}},r=this.selections.map(i=>{const n=this.getText(i),{delimiter:s,pattern:a}=e[t];return n.match(a)?this.removeInline(i,s):`${s}${n}${s}`});this.codemirror.replaceSelections(r,"around"),this.codemirror.focus()},toggleBlock(t){const e=this.selections.map(r=>{const i=this.getText(r),n="```";return i.match(new RegExp("^```(.*)\n(.*)\n```$"))?this.removeInline(r,n):`${n}
${i}
${n}`});this.codemirror.replaceSelections(e,"around"),this.codemirror.focus()},removeInline(t,e){return this.getText(t).slice(e.length,-e.length)},toggleLine(t){const e=this.codemirror.getCursor("start"),r=this.codemirror.getCursor("end"),i={quote:/^(\s*)\>\s+/,"unordered-list":/^(\s*)(\*|\-|\+)\s+/,"ordered-list":/^(\s*)\d+\.\s+/},n={quote:"> ","unordered-list":"- ","ordered-list":"1. "};for(let s=e.line;s<=r.line;s++){const a=this.codemirror.getLine(s),c=this.isInside(t)?a.replace(i[t],"$1"):n[t]+a;this.codemirror.replaceRange(c,{line:s,ch:0},{line:s,ch:1/0})}this.codemirror.focus()},getState(t){t=t||this.codemirror.getCursor("start");const e=this.codemirror.getTokenAt(t);if(!e.type)return{};const r=e.type.split(" "),i={},n=this.codemirror.getLine(t.line);return r.forEach(s=>{switch(s){case"strong":i.bold=!0;break;case"variable-2":i[/^\s*\d+\.\s/.test(n)?"ordered-list":"unordered-list"]=!0;break;case"atom":case"quote":i.quote=!0;break;case"em":i.italic=!0;break;case"strikethrough":i.strikethrough=!0;break;case"comment":i.code=!0;break;case"link":i.link=!0;break;case"tag":i.image=!0;break;default:s.match(/^header(\-[1-6])?$/)&&(i[s.replace("header","heading")]=!0)}}),i},isInside(t){return this.getState()[t]??!1},insertTable(){const t=this.codemirror.getDoc(),e=t.getCursor(),r=t.getLine(e.line),i={line:e.line},n=`|     |     |
| --- | --- |
|     |     |`;r.length===0?t.replaceRange(n,i):(t.replaceRange(`

`+n,i),e.line+=2),this.codemirror.focus(),this.codemirror.setCursor(e.line,2)},insertImage(t,e){const r=this.codemirror.doc,i=r.somethingSelected()?r.getSelection():e||"",n=`![${i}](${t||""})`;r.replaceSelection(n,"start");const s=r.getCursor().line,a=r.getCursor().ch+2,c=a+i.length;r.setSelection({line:s,ch:a},{line:s,ch:c}),this.codemirror.focus()},appendImage(t,e=""){this.data+=`

![${e}](${t})`},insertLink(t,e){const r=this.codemirror.doc,i=r.somethingSelected()?r.getSelection():e||"";if(!t&&(t=prompt(__("Enter URL"),"https://"),!t))return;const n=`[${i}](${t})`;r.replaceSelection(n,"start");const s=r.getCursor().line,a=r.getCursor().ch+1,c=a+i.length;r.setSelection({line:s,ch:a},{line:s,ch:c}),this.codemirror.focus()},appendLink(t,e=""){this.data+=`

[${e}](${t})`},addAsset(){this.assetsEnabled&&(this.showAssetSelector=!0)},shortcut(t){if(t.keyCode===27){t.preventDefault(),this.codemirror.getInputField().blur();return}if(!(t.metaKey||t.ctrlKey))return;if(this.assetsEnabled&&t.shiftKey&&t.keyCode===65){t.preventDefault(),this.addAsset();return}const r={66:()=>this.toggleInline("bold"),73:()=>this.toggleInline("italic")};r[t.keyCode]&&(t.preventDefault(),r[t.keyCode]())},assetsSelected(t){this.closeAssetSelector(),this.selectedAssets=[],this.$axios.post(cp_url("assets-fieldtype"),{assets:t}).then(({data:e})=>{e.forEach(r=>{const i=r.values.alt||"",n=encodeURI(`statamic://${r.reference}`),s=t.length===1?"insert":"append";r.isImage?this[`${s}Image`](n,i):this[`${s}Link`](n,i)})})},closeAssetSelector(){this.showAssetSelector=!1},uploadsUpdated(t){this.uploads=t},uploadComplete(t,e){t.is_image?this.insertImage(t.url):this.insertLink(t.url),e.length>1&&this.codemirror.setCursor(this.codemirror.lineCount(),0)},focus(){this.codemirror.focus()},focusCodeMirror(){this.codemirror&&this.codemirror.focus()},trackHeightUpdates(){this.$events.$on("livepreview.opened",this.throttledResizeEvent),this.$events.$on("livepreview.closed",this.throttledResizeEvent),this.$events.$on("livepreview.resizing",this.throttledResizeEvent)},throttledResizeEvent:he(function(){window.dispatchEvent(new Event("resize"))},100),updateMarkdownPreview(){this.$axios.post(this.meta.previewUrl,{value:this.data,config:this.config}).then(t=>this.markdownPreviewText=t.data).catch(t=>this.$toast.error(t.response?t.response.data.message:__("Something went wrong")))},initCodeMirror(){var t=this;t.codemirror=xe(_e(this.$refs.codemirror,{value:t.data,mode:"gfm",dragDrop:!1,keyMap:"sublime",direction:document.querySelector("html").getAttribute("dir")??"ltr",lineWrapping:!0,viewportMargin:1/0,tabindex:0,autoRefresh:!0,readOnly:t.isReadOnly?"nocursor":!1,inputStyle:"contenteditable",spellcheck:!0,extraKeys:{Enter:"newlineAndIndentContinueMarkdownList","Cmd-Left":"goLineLeftSmart"}})),this.toolbarIsFloating&&(t.codemirror.on("cursorActivity",this.handleCursorActivity),t.codemirror.on("blur",this.hideFloatingToolbar)),t.codemirror.on("change",function(e){t.data=e.doc.getValue()}),t.codemirror.on("focus",()=>t.$emit("focus")),t.codemirror.on("blur",()=>t.$emit("blur")),t.codemirror.on("beforeSelectionChange",function(e,r){t.selections=r.ranges}),this.$watch("value",function(e){e!==t.codemirror.doc.getValue()&&t.codemirror.doc.setValue(e)}),this.trackHeightUpdates()},initToolbarButtons(){let t=this.config.buttons.map(e=>ye().find(r=>r.name===e.toLowerCase())||e);t=t.filter(e=>e.condition?e.condition.call(null,this.config):!0),this.buttons=t},updateCount(t){const e=t.trim(),r=Ie(e.replace(/\s/g,"")).length,i=e.split(/\s+/).filter(n=>n.length>0).length;this.count={characters:r,words:i}},handleButtonClick(t){t(this)},handleCursorActivity(){if(!this.toolbarIsFloating)return;const t=this.codemirror.getSelection();if(t&&t.length>0&&!this.isReadOnly){const e=this.codemirror.getDoc();this.selections=e.listSelections(),this.showFloatingToolbar=!0,this.updateFloatingToolbarPosition()}else this.showFloatingToolbar=!1},hideFloatingToolbar(){this.showFloatingToolbar=!1},updateFloatingToolbarPosition(){if(!this.codemirror||!this.showFloatingToolbar)return;const t=this.codemirror.getCursor("from"),e=this.codemirror.getCursor("to"),r=this.codemirror.cursorCoords(t),i=this.codemirror.cursorCoords(e),n=this.codemirror.getWrapperElement().getBoundingClientRect(),s=Math.round((r.left+i.right)/2-n.left),a=Math.round(r.top-n.top-50);this.floatingToolbarX=s,this.floatingToolbarY=a}},computed:{assetsEnabled(){return!!this.config?.container},container(){return this.meta.assets?.container},assetSelectorColumns(){return this.meta.assets?.columns},editor(){return this},folder(){return this.config.folder||"/"},restrictAssetNavigation(){return this.config.restrict_assets||!1},toolbarIsFixed(){return this.config.toolbar_mode==="fixed"},toolbarIsFloating(){return this.config.toolbar_mode==="floating"},showFixedToolbar(){return this.toolbarIsFixed&&this.buttons.length>0},replicatorPreview(){if(this.showFieldPreviews)return be(this.data||"",{renderer:new Se}).replace(/<\/?[^>]+(>|$)/g,"")},internalFieldActions(){return[{title:__("Toggle Fullscreen Mode"),icon:({vm:t})=>t.fullScreenMode?"fullscreen-close":"fullscreen-open",quick:!0,visibleWhenReadOnly:!0,run:this.toggleFullscreen}]}}},Oe={class:"drag-notification"},Pe=["id"],Ee={class:"markdown-cheatsheet-helper"},Le={key:0,class:"flex items-center pe-2 gap-2 sm:gap-3 text-xs"},ze={class:"whitespace-nowrap"},Ue=["textContent"],De={class:"whitespace-nowrap"},qe=["textContent"],He={key:1,class:"drag-notification"},Ve=["innerHTML"],We=["innerHTML"];function Ke(t,e,r,i,n,s){const a=T("markdown-toolbar"),c=T("publish-field-fullscreen-header"),S=T("ui-icon"),v=T("uploads"),f=T("Button"),w=T("uploader"),b=T("asset-selector"),C=T("Stack"),A=T("portal"),R=ie("tooltip");return k(),P(A,{name:"markdown-fullscreen",disabled:!n.fullScreenMode,"target-class":"markdown-fieldtype"},{default:D(()=>[y("div",null,[y("div",{class:V(["@container/markdown w-full block bg-white dark:bg-gray-900! rounded-lg relative border border-gray-300 with-contrast:border-gray-500 dark:border-white/15 dark:inset-shadow-2xs dark:inset-shadow-black text-gray-900 dark:text-gray-300 appearance-none antialiased shadow-ui-sm disabled:shadow-none",{"markdown-fullscreen":n.fullScreenMode,"markdown-dark-mode":n.darkMode,"border-dashed":t.isReadOnly}])},[$(w,{ref:"uploader",enabled:s.assetsEnabled,container:s.container?.id,path:s.folder,onUpdated:s.uploadsUpdated,onUploadComplete:s.uploadComplete},{default:D(({dragging:p})=>[y("div",null,[n.fullScreenMode?(k(),P(c,{key:0,title:t.config.display,"field-actions":t.fieldActions,onClose:s.toggleFullscreen},{default:D(()=>[n.fullScreenMode?(k(),P(a,{key:0,mode:n.mode,"onUpdate:mode":e[0]||(e[0]=o=>n.mode=o),buttons:n.buttons,"is-read-only":t.isReadOnly,"show-dark-mode":n.fullScreenMode,"dark-mode":n.darkMode,"is-fullscreen":!0,onToggleDarkMode:s.toggleDarkMode,onButtonClick:s.handleButtonClick},null,8,["mode","buttons","is-read-only","show-dark-mode","dark-mode","onToggleDarkMode","onButtonClick"])):F("",!0)]),_:1},8,["title","field-actions","onClose"])):F("",!0),!n.fullScreenMode&&s.showFixedToolbar?(k(),P(a,{key:1,mode:n.mode,"onUpdate:mode":e[1]||(e[1]=o=>n.mode=o),buttons:n.buttons,"is-read-only":t.isReadOnly,"show-dark-mode":!1,"dark-mode":n.darkMode,"is-fullscreen":!1,onToggleDarkMode:s.toggleDarkMode,onButtonClick:s.handleButtonClick,class:"sticky z-(--z-index-portal) top-0 sm:-top-2 mb-2 [&~*]:-mt-2"},null,8,["mode","buttons","is-read-only","dark-mode","onToggleDarkMode","onButtonClick"])):F("",!0),z(y("div",Oe,[$(S,{name:"upload",class:"mb-4 size-12"}),W(" "+U(t.__("Drop File to Upload")),1)],512),[[X,p]]),n.uploads.length?(k(),P(v,{key:2,uploads:n.uploads,class:"-mt-px"},null,8,["uploads"])):F("",!0),y("div",{class:V(`mode-wrap mode-${n.mode}`,{"prose p-3":n.mode=="preview"}),onClick:e[9]||(e[9]=(...o)=>s.focus&&s.focus(...o))},[z(y("div",{class:"markdown-writer",ref:"writer",onDragover:e[5]||(e[5]=o=>n.draggingFile=!0),onDragleave:e[6]||(e[6]=o=>n.draggingFile=!1),onDrop:e[7]||(e[7]=o=>n.draggingFile=!1),onKeydown:e[8]||(e[8]=(...o)=>s.shortcut&&s.shortcut(...o))},[y("div",{class:V(["editor relative top-[0.5px] z-(--z-index-above) st-text-legibility",{"focus-within:focus-outline":!n.fullScreenMode}]),ref:"codemirror"},[n.showFloatingToolbar&&s.toolbarIsFloating&&!t.isReadOnly?(k(),E("div",{key:0,class:"markdown-floating-toolbar absolute z-50 flex items-center gap-1 rounded-lg border border-gray-300 bg-white px-2 py-1 shadow-lg dark:border-white/10 dark:bg-gray-900",style:we({left:`${n.floatingToolbarX}px`,top:`${n.floatingToolbarY}px`}),onMousedown:e[2]||(e[2]=ke(()=>{},["prevent"]))},[(k(!0),E(le,null,ae(n.buttons,o=>z((k(),P(f,{"aria-label":o.text,icon:o.svg,key:o.name,onClick:l=>s.handleButtonClick(o.command),size:"sm",variant:"ghost"},null,8,["aria-label","icon","onClick"])),[[R,o.text]])),128))],36)):F("",!0)],2),t.id?(k(),E("input",{key:0,id:t.id,type:"text",class:"sr-only",onFocus:e[3]||(e[3]=(...o)=>s.focusCodeMirror&&s.focusCodeMirror(...o)),tabindex:"-1"},null,40,Pe)):F("",!0),y("footer",{class:V(["flex items-center justify-between bg-gray-50 dark:bg-gray-900 rounded-b-[calc(var(--radius-lg)-1px)] border-t border-gray-300 dark:border-white/10 p-1 text-sm w-full",{"absolute inset-x-0 bottom-0 rounded-none z-(--z-index-above)":n.fullScreenMode}])},[y("div",Ee,[$(f,{icon:"markdown",size:"sm",variant:"subtle",onClick:e[4]||(e[4]=o=>n.showCheatsheet=!0),"aria-label":t.__("Show Markdown Cheatsheet"),text:t.__("Markdown Cheatsheet")},null,8,["aria-label","text"])]),n.fullScreenMode?(k(),E("div",Le,[y("div",ze,[y("span",{textContent:U(n.count.words)},null,8,Ue),W(" "+U(t.__("Words")),1)]),y("div",De,[y("span",{textContent:U(n.count.characters)},null,8,qe),W(" "+U(t.__("Characters")),1)])])):F("",!0)],2),s.assetsEnabled&&n.draggingFile?(k(),E("div",He,[$(S,{name:"upload",class:"mb-4 size-12"}),W(" "+U(t.__("Drop File to Upload")),1)])):F("",!0)],544),[[X,n.mode=="write"]]),z(y("div",{innerHTML:n.markdownPreviewText,class:"markdown-preview p-3 prose prose-sm @md/markdown:prose-base"},null,8,Ve),[[X,n.mode=="preview"]])],2)])]),_:1},8,["enabled","container","path","onUpdated","onUploadComplete"]),t.isReadOnly?F("",!0):(k(),P(C,{key:0,open:n.showAssetSelector,inset:"","show-close-button":!1},{default:D(()=>[$(b,{container:s.container,folder:s.folder,selected:n.selectedAssets,"restrict-folder-navigation":s.restrictAssetNavigation,columns:s.assetSelectorColumns,onSelected:s.assetsSelected,onClosed:s.closeAssetSelector},null,8,["container","folder","selected","restrict-folder-navigation","columns","onSelected","onClosed"])]),_:1},8,["open"])),$(C,{size:"narrow",open:n.showCheatsheet,"onUpdate:open":e[10]||(e[10]=p=>n.showCheatsheet=p),title:t.__("Markdown Cheatsheet")},{default:D(()=>[y("div",{class:"prose prose-zinc prose-headings:font-medium prose-pre:prose-code:!text-white mx-auto max-w-3xl [&>*:first-child]:![margin-block-start:0]",innerHTML:t.__("markdown.cheatsheet")},null,8,We)]),_:1},8,["open","title"])],2)])]),_:1},8,["disabled"])}const Ge=ne($e,[["render",Ke]]);export{Ge as default};
